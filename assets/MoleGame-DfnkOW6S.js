import{r,u as T,j as e,B as C}from"./index-CviBvuO_.js";import{L as I,A as L,m as P}from"./Layout-DWGereyf.js";import{G as A}from"./GameShell-D7iUMIaC.js";import{P as E}from"./play-Cz7ctb1O.js";import"./confetti.module-CKEGaJVs.js";import"./use-scores-DGCWyIxn.js";import"./input-BWSWGmnF.js";function F(){const[o,i]=r.useState(Array(9).fill("hidden")),[N,c]=r.useState(0),[l,h]=r.useState(30),[n,p]=r.useState(!1),[b,g]=r.useState(!1),{playClick:w,playCorrect:G,playWrong:k}=T(),m=r.useRef(null),u=r.useRef(null);r.useEffect(()=>()=>{v()},[]),r.useEffect(()=>{n&&l===0&&M()},[l,n]);const j=()=>{p(!0),g(!1),c(0),h(30),i(Array(9).fill("hidden")),w(),m.current=setInterval(()=>{h(t=>t-1)},1e3),y()},v=()=>{m.current&&clearInterval(m.current),u.current&&clearTimeout(u.current),p(!1)},M=()=>{v(),g(!0)},y=()=>{if(!n&&l<=0)return;const t=Math.max(500,1e3-(30-l)*15);u.current=setTimeout(()=>{S(),y()},t)},S=()=>{i(t=>{const s=[...t];if(Math.random()>.5)for(let x=0;x<9;x++)s[x]="hidden";const d=Math.floor(Math.random()*9),a=Math.random();let f="mole";return a>.8&&(f="golden"),a<.1&&(f="bomb"),s[d]=f,s}),setTimeout(()=>{i(t=>[...t])},1500)},R=t=>{if(!n||o[t]==="hidden")return;const s=o[t],d=[...o];d[t]="hidden",i(d),s==="bomb"?(c(a=>Math.max(0,a-5)),k()):s==="golden"?(c(a=>a+5),G()):(c(a=>a+1),w())};return e.jsx(I,{children:e.jsx(A,{title:"æ‰“åœ°é¼ å¤§æŒ‘æˆ°",score:N,totalQuestions:30,currentQuestionIndex:30-l,gameType:"math",isGameOver:b,onRestart:j,colorClass:"bg-gradient-to-br from-green-400 to-teal-500 text-white",children:e.jsxs("div",{className:"flex flex-col items-center gap-6 w-full max-w-2xl mx-auto",children:[!n&&!b&&e.jsxs("div",{className:"bg-white/90 backdrop-blur-md p-8 rounded-3xl text-center shadow-xl",children:[e.jsx("h3",{className:"text-3xl font-black text-[hsl(var(--macaron-green-dark))] mb-4",children:"æº–å‚™å¥½äº†å—ï¼Ÿ"}),e.jsxs("p",{className:"text-lg text-gray-600 mb-6 font-bold",children:["é»æ“Šè·³å‡ºä¾†çš„åœ°é¼ ï¼",e.jsx("br",{}),e.jsx("span",{className:"text-yellow-500",children:"é‡‘è‰²åœ°é¼  +5 åˆ†"}),e.jsx("br",{}),e.jsx("span",{className:"text-red-500",children:"ç‚¸å½ˆ -5 åˆ†"})]}),e.jsxs(C,{onClick:j,className:"btn-macaron bg-[hsl(var(--macaron-green))] text-[hsl(var(--macaron-green-dark))] text-2xl py-8 px-12 rounded-full w-full shadow-lg hover:scale-105 transition-transform",children:[e.jsx(E,{className:"w-8 h-8 mr-2 fill-current"}),"é–‹å§‹éŠæˆ²"]})]}),n&&e.jsx("div",{className:"grid grid-cols-3 gap-4 md:gap-6 w-full max-w-[400px] aspect-square",children:o.map((t,s)=>e.jsxs("div",{className:"bg-black/20 rounded-3xl relative overflow-hidden cursor-pointer active:scale-95 transition-transform shadow-inner border-b-4 border-white/10",onClick:()=>R(s),children:[e.jsx("div",{className:"absolute bottom-[-20%] left-[10%] w-[80%] h-[40%] bg-black/40 rounded-full blur-md"}),e.jsx(L,{children:t!=="hidden"&&e.jsx(P.div,{initial:{y:"100%"},animate:{y:"10%"},exit:{y:"100%"},transition:{type:"spring",stiffness:300,damping:20},className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsxs("span",{className:"text-6xl md:text-7xl filter drop-shadow-xl select-none",children:[t==="mole"&&"ğŸ¹",t==="golden"&&"ğŸ‘‘",t==="bomb"&&"ğŸ’£"]})})})]},s))}),n&&e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm px-6 py-2 rounded-full font-display text-2xl font-bold border-2 border-white/50",children:["å‰©é¤˜æ™‚é–“: ",l," ç§’"]})]})})})}export{F as default};
