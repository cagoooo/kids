import{r as d,j as t}from"./index-dxj7E4H-.js";import{L as P,m as $}from"./Layout-CmlOHSNV.js";import{G as F}from"./GameShell-CODfseyM.js";import{e as L}from"./confetti.module-BS7HiWFO.js";import{D as R,u as B,a as G}from"./core.esm-BMKAPAw8.js";import"./use-scores-D77kwo0O.js";import"./input-R0n0rv70.js";const h=[{id:1,emoji:"ğŸ ",name:"æˆ¿å­"},{id:2,emoji:"ğŸŒ¸",name:"æ«»èŠ±"},{id:3,emoji:"ğŸ±",name:"å°è²“"},{id:4,emoji:"ğŸŒˆ",name:"å½©è™¹"},{id:5,emoji:"ğŸ‚",name:"è›‹ç³•"},{id:6,emoji:"ğŸš—",name:"æ±½è»Š"},{id:7,emoji:"ğŸŒ»",name:"å‘æ—¥è‘µ"},{id:8,emoji:"ğŸ¦‹",name:"è´è¶"},{id:9,emoji:"ğŸˆ",name:"æ°£çƒ"},{id:10,emoji:"â­",name:"æ˜Ÿæ˜Ÿ"}],j=["â‘ ","â‘¡","â‘¢","â‘£"],O=["bg-red-100 border-red-300","bg-blue-100 border-blue-300","bg-green-100 border-green-300","bg-yellow-100 border-yellow-300"];function Q({id:n,pieceIndex:r,emoji:o}){const{attributes:a,listeners:x,setNodeRef:c,transform:i,isDragging:p}=G({id:n}),m=i?{transform:`translate3d(${i.x}px, ${i.y}px, 0)`,zIndex:p?100:1}:void 0;return t.jsxs($.div,{ref:c,style:m,...x,...a,className:`w-20 h-20 md:w-24 md:h-24 rounded-xl shadow-lg flex flex-col items-center justify-center cursor-grab active:cursor-grabbing border-2 ${O[r]} ${p?"opacity-80":""}`,whileHover:{scale:1.05},"data-testid":`puzzle-piece-${r}`,children:[t.jsx("span",{className:"text-3xl md:text-4xl",children:o}),t.jsx("span",{className:"text-lg font-bold",children:j[r]})]})}function k({id:n,slotIndex:r,children:o,isCorrect:a}){const{setNodeRef:x,isOver:c}=B({id:n});return t.jsx("div",{ref:x,className:`w-20 h-20 md:w-24 md:h-24 rounded-xl border-2 border-dashed flex flex-col items-center justify-center transition-colors ${c?"border-green-400 bg-green-50":a?"border-green-400 bg-green-100":"border-gray-300 bg-gray-50"}`,"data-testid":`puzzle-slot-${n}`,children:o||t.jsx("span",{className:"text-2xl font-bold text-gray-400",children:j[r]})})}function U(){const[n,r]=d.useState(0),[o,a]=d.useState(0),[x,c]=d.useState(!1),[i,p]=d.useState(h[0]),[m,I]=d.useState([]),[b,v]=d.useState([]),y=()=>{if(n>=10){c(!0);return}const e=h[n%h.length];p(e);const s=[...[{id:"piece-0",pieceIndex:0,placed:!1},{id:"piece-1",pieceIndex:1,placed:!1},{id:"piece-2",pieceIndex:2,placed:!1},{id:"piece-3",pieceIndex:3,placed:!1}]].sort(()=>.5-Math.random());I(s),v([{id:"slot-0",slotIndex:0,pieceId:null},{id:"slot-1",slotIndex:1,pieceId:null},{id:"slot-2",slotIndex:2,pieceId:null},{id:"slot-3",slotIndex:3,pieceId:null}])};d.useEffect(()=>{y()},[n]);const w=e=>{e.every(s=>s.pieceId?parseInt(s.pieceId.split("-")[1])===s.slotIndex:!1)&&(L({particleCount:50,spread:60,origin:{y:.6},colors:["#FFD93D","#6BCB77","#4D96FF","#FF6B6B"]}),a(s=>s+10),setTimeout(()=>r(s=>s+1),800))},z=e=>{const{active:f,over:s}=e;if(!s)return;const u=f.id,g=s.id;if(!g.startsWith("slot-"))return;const C=parseInt(g.split("-")[1]),D=parseInt(u.split("-")[1]);if(C===D){const N=b.map(l=>l.id===g?{...l,pieceId:u}:l);v(N);const E=m.map(l=>l.id===u?{...l,placed:!0}:l);I(E),w(N)}},S=()=>{r(0),a(0),c(!1),y()};return t.jsx(P,{children:t.jsx(F,{title:"æ‹¼åœ–æŒ‘æˆ°",score:o,totalQuestions:10,currentQuestionIndex:n,gameType:"puzzle",isGameOver:x,onRestart:S,colorClass:"bg-[hsl(var(--macaron-yellow))] text-[hsl(var(--macaron-yellow-dark))]",children:t.jsx(R,{onDragEnd:z,children:t.jsxs("div",{className:"flex flex-col items-center gap-6 md:gap-8",children:[t.jsx("h3",{className:"font-display text-xl sm:text-2xl md:text-3xl font-bold text-center",children:"æŠŠæ‹¼åœ–æ”¾åˆ°æ­£ç¢ºçš„ä½ç½®ï¼"}),t.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6 md:gap-8",children:[t.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-white/50 rounded-2xl",children:b.map(e=>t.jsx(k,{id:e.id,slotIndex:e.slotIndex,isCorrect:e.pieceId!==null&&parseInt(e.pieceId.split("-")[1])===e.slotIndex,children:e.pieceId&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-3xl md:text-4xl",children:i.emoji}),t.jsx("span",{className:"text-lg font-bold",children:j[e.slotIndex]})]})},e.id))}),t.jsx("div",{className:"text-4xl md:text-6xl font-bold text-white/50",children:"="}),t.jsx("div",{className:"text-[5rem] md:text-[7rem] bg-white/30 p-4 rounded-2xl",children:i.emoji})]}),t.jsxs("div",{className:"flex gap-3 flex-wrap justify-center p-4 bg-white/30 rounded-2xl min-h-[100px]",children:[m.filter(e=>!e.placed).map(e=>t.jsx(Q,{id:e.id,pieceIndex:e.pieceIndex,emoji:i.emoji},e.id)),m.every(e=>e.placed)&&t.jsx("div",{className:"flex items-center text-green-600 font-bold",children:"å®Œæˆï¼"})]}),t.jsx("p",{className:"text-sm md:text-base text-center opacity-70",children:"æŠŠç·¨è™Ÿ â‘ â‘¡â‘¢â‘£ çš„æ‹¼åœ–æ‹–åˆ°ä¸Šæ–¹å°æ‡‰çš„ä½ç½®"})]})})})})}export{U as default};
