import{r as a,j as s}from"./index-CD2wNbFC.js";import{L as z,m as w}from"./Layout-DFM5YMEB.js";import{G as A,c as S}from"./GameShell-BDxTv0Re.js";import{u as I}from"./use-tts-DqP_SXTa.js";import"./use-scores-CDq8lC3W.js";import"./dialog-Vj9oaDWx.js";import"./input-CR4HPgh5.js";const L=[{emoji:"ğŸ°",name:"å…”å­"},{emoji:"ğŸ»",name:"ç†Š"},{emoji:"ğŸ¦Š",name:"ç‹ç‹¸"},{emoji:"ğŸ¼",name:"ç†Šè²“"},{emoji:"ğŸ¨",name:"ç„¡å°¾ç†Š"},{emoji:"ğŸ¦",name:"ç…å­"},{emoji:"ğŸ¯",name:"è€è™"},{emoji:"ğŸ¸",name:"é’è›™"}];function B(){const[m,g]=a.useState(0),[M,b]=a.useState(0),[l,c]=a.useState([]),[N,h]=a.useState([]),[v,f]=a.useState(!1),[y,j]=a.useState(0),[p,k]=a.useState(6),[F,C]=a.useState(!1),{speak:o}=I(),P=()=>{const e=m<3?6:8;return k(e),[...L].sort(()=>.5-Math.random()).slice(0,e).flatMap((t,n)=>[{id:n*2,...t,isFlipped:!1,isMatched:!1},{id:n*2+1,...t,isFlipped:!1,isMatched:!1}]).sort(()=>.5-Math.random())};a.useEffect(()=>{if(m>=5){C(!0);return}c(P()),h([]),j(0),f(!1),o("ç¿»é–‹å¡ç‰‡ï¼Œæ‰¾åˆ°ä¸€æ¨£çš„å‹•ç‰©ï¼")},[m]);const T=e=>{if(v)return;const d=l.find(t=>t.id===e);if(!d||d.isFlipped||d.isMatched)return;const x=[...N,e];if(h(x),c(l.map(t=>t.id===e?{...t,isFlipped:!0}:t)),o(d.name),x.length===2){f(!0);const[t,n]=x,D=l.find(r=>r.id===t),E=l.find(r=>r.id===n);setTimeout(()=>{if(D.emoji===E.emoji){S({particleCount:30,spread:40,origin:{y:.6}}),o("é…å°æˆåŠŸï¼"),c(i=>i.map(u=>u.id===t||u.id===n?{...u,isMatched:!0}:u));const r=y+1;j(r),b(i=>i+10),r===p&&(S({particleCount:100,spread:70,origin:{y:.6}}),o("å¤ªæ£’äº†ï¼å…¨éƒ¨é…å°å®Œæˆï¼"),setTimeout(()=>g(i=>i+1),1500))}else o("ä¸ä¸€æ¨£å–”ï¼Œå†è¨˜ä¸€æ¬¡ï¼"),c(r=>r.map(i=>i.id===t||i.id===n?{...i,isFlipped:!1}:i));h([]),f(!1)},1e3)}},G=()=>{g(0),b(0),C(!1),j(0)},R="grid-cols-4",$=p===6?"w-14 h-14 sm:w-16 sm:h-16 md:w-20 md:h-20":"w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16";return s.jsx(z,{children:s.jsx(A,{title:"é­”æ³•ç¿»ç¿»ç‰Œ",score:M,totalQuestions:5,currentQuestionIndex:m,gameType:"memory",isGameOver:F,onRestart:G,colorClass:"bg-[hsl(var(--macaron-purple))] text-[hsl(var(--macaron-purple-dark))]",children:s.jsxs("div",{className:"flex flex-col items-center gap-3 sm:gap-4 md:gap-6",children:[s.jsx("h3",{className:"font-display text-base sm:text-lg md:text-xl font-bold text-center px-2",children:"æ‰¾åˆ°ä¸€æ¨£çš„å‹•ç‰©æœ‹å‹ï¼"}),s.jsxs("div",{className:"text-sm sm:text-base font-medium",children:["å·²é…å°ï¼š",y," / ",p]}),s.jsx("div",{className:`grid ${R} gap-2 sm:gap-3`,children:l.map(e=>s.jsx(w.button,{onClick:()=>T(e.id),disabled:e.isFlipped||e.isMatched||v,className:`
                  ${$} rounded-xl sm:rounded-2xl shadow-lg relative
                  ${e.isMatched?"opacity-0 pointer-events-none":""}
                `,whileHover:{scale:e.isFlipped||e.isMatched?1:1.05},whileTap:{scale:.95},"data-testid":`card-${e.id}`,children:s.jsxs(w.div,{className:"w-full h-full relative",initial:!1,animate:{rotateY:e.isFlipped?180:0},transition:{duration:.4},style:{transformStyle:"preserve-3d"},children:[s.jsx("div",{className:"absolute inset-0 bg-[hsl(var(--macaron-purple))] rounded-xl sm:rounded-2xl flex items-center justify-center border-4 border-white",style:{backfaceVisibility:"hidden"},children:s.jsx("span",{className:"text-xl sm:text-2xl md:text-3xl text-white",children:"?"})}),s.jsx("div",{className:"absolute inset-0 bg-white rounded-xl sm:rounded-2xl flex items-center justify-center border-4 border-[hsl(var(--macaron-purple))]",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:s.jsx("span",{className:"text-2xl sm:text-3xl md:text-4xl",children:e.emoji})})]})},e.id))}),s.jsx("p",{className:"text-xs sm:text-sm text-center opacity-70 px-4",children:"ç¿»é–‹å…©å¼µå¡ç‰‡ï¼Œå¦‚æœåœ–æ¡ˆä¸€æ¨£å°±æœƒæ¶ˆå¤±å¾—åˆ†ï¼"})]})})})}export{B as default};
