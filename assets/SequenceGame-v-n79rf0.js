import{r as f,a as H,j as v}from"./index-BAFbHnVU.js";import{L as ue,m as fe}from"./Layout-DFwKD3LY.js";import{G as me,c as ge}from"./GameShell-umGkXZuk.js";import{b as xe,c as pe,d as K,u as ve,a as be,e as he,C as M,i as Ie,g as ye,K as T,D as we,f as Re}from"./core.esm-DgCrUvum.js";import"./use-scores-DiF6HJ8X.js";import"./useQuery-_qmAEel5.js";import"./dialog-CWCHvEy3.js";import"./input-DK6-qLvW.js";function z(e,n,t){const r=e.slice();return r.splice(t<0?r.length+t:t,0,r.splice(n,1)[0]),r}function Se(e,n){return e.reduce((t,r,s)=>{const o=n.get(r);return o&&(t[s]=o),t},Array(e.length))}function O(e){return e!==null&&e>=0}function De(e,n){if(e===n)return!0;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}function Ce(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const q={scaleX:1,scaleY:1},je=e=>{var n;let{rects:t,activeNodeRect:r,activeIndex:s,overIndex:o,index:i}=e;const a=(n=t[s])!=null?n:r;if(!a)return null;const c=Ne(t,i,s);if(i===s){const d=t[o];return d?{x:s<o?d.left+d.width-(a.left+a.width):d.left-a.left,y:0,...q}:null}return i>s&&i<=o?{x:-a.width-c,y:0,...q}:i<s&&i>=o?{x:a.width+c,y:0,...q}:{x:0,y:0,...q}};function Ne(e,n,t){const r=e[n],s=e[n-1],o=e[n+1];return!r||!s&&!o?0:t<n?s?r.left-(s.left+s.width):o.left-(r.left+r.width):o?o.left-(r.left+r.width):r.left-(s.left+s.width)}const U=e=>{let{rects:n,activeIndex:t,overIndex:r,index:s}=e;const o=z(n,r,t),i=n[s],a=o[s];return!a||!i?null:{x:a.left-i.left,y:a.top-i.top,scaleX:a.width/i.width,scaleY:a.height/i.height}},Y="Sortable",V=H.createContext({activeIndex:-1,containerId:Y,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:U,disabled:{draggable:!1,droppable:!1}});function Ee(e){let{children:n,id:t,items:r,strategy:s=U,disabled:o=!1}=e;const{active:i,dragOverlay:a,droppableRects:c,over:d,measureDroppableContainers:l}=xe(),h=pe(Y,t),y=a.rect!==null,p=f.useMemo(()=>r.map(S=>typeof S=="object"&&"id"in S?S.id:S),[r]),m=i!=null,b=i?p.indexOf(i.id):-1,u=d?p.indexOf(d.id):-1,I=f.useRef(p),R=!De(p,I.current),w=u!==-1&&b===-1||R,g=Ce(o);K(()=>{R&&m&&l(p)},[R,p,m,l]),f.useEffect(()=>{I.current=p},[p]);const j=f.useMemo(()=>({activeIndex:b,containerId:h,disabled:g,disableTransforms:w,items:p,overIndex:u,useDragOverlay:y,sortedRects:Se(p,c),strategy:s}),[b,h,g.draggable,g.droppable,w,p,u,c,y,s]);return H.createElement(V.Provider,{value:j},n)}const Te=e=>{let{id:n,items:t,activeIndex:r,overIndex:s}=e;return z(t,r,s).indexOf(n)},Oe=e=>{let{containerId:n,isSorting:t,wasDragging:r,index:s,items:o,newIndex:i,previousItems:a,previousContainerId:c,transition:d}=e;return!d||!r||a!==o&&s===i?!1:t?!0:i!==s&&n===c},qe={duration:200,easing:"ease"},J="transform",Ae=M.Transition.toString({property:J,duration:0,easing:"linear"}),Le={roleDescription:"sortable"};function Ge(e){let{disabled:n,index:t,node:r,rect:s}=e;const[o,i]=f.useState(null),a=f.useRef(t);return K(()=>{if(!n&&t!==a.current&&r.current){const c=s.current;if(c){const d=ye(r.current,{ignoreTransform:!0}),l={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(l.x||l.y)&&i(l)}}t!==a.current&&(a.current=t)},[n,t,r,s]),f.useEffect(()=>{o&&i(null)},[o]),o}function Me(e){let{animateLayoutChanges:n=Oe,attributes:t,disabled:r,data:s,getNewIndex:o=Te,id:i,strategy:a,resizeObserverConfig:c,transition:d=qe}=e;const{items:l,containerId:h,activeIndex:y,disabled:p,disableTransforms:m,sortedRects:b,overIndex:u,useDragOverlay:I,strategy:R}=f.useContext(V),w=ze(r,p),g=l.indexOf(i),j=f.useMemo(()=>({sortable:{containerId:h,index:g,items:l},...s}),[h,s,g,l]),S=f.useMemo(()=>l.slice(l.indexOf(i)),[l,i]),{rect:F,node:$,isOver:W,setNodeRef:B}=ve({id:i,data:j,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...c}}),{active:N,activatorEvent:Z,activeNodeRect:ee,attributes:te,setNodeRef:P,listeners:re,isDragging:A,over:ne,setActivatorNodeRef:se,transform:ie}=be({id:i,data:j,attributes:{...Le,...t},disabled:w.draggable}),oe=he(B,P),D=!!N,Q=D&&!m&&O(y)&&O(u),X=!I&&A,_=X&&Q?ie:null,ae=Q?_??(a??R)({rects:b,activeNodeRect:ee,activeIndex:y,overIndex:u,index:g}):null,E=O(y)&&O(u)?o({id:i,items:l,activeIndex:y,overIndex:u}):g,C=N?.id,x=f.useRef({activeId:C,items:l,newIndex:E,containerId:h}),ce=l!==x.current.items,k=n({active:N,containerId:h,isDragging:A,isSorting:D,id:i,index:g,items:l,newIndex:x.current.newIndex,previousItems:x.current.items,previousContainerId:x.current.containerId,transition:d,wasDragging:x.current.activeId!=null}),L=Ge({disabled:!k,index:g,node:$,rect:F});return f.useEffect(()=>{D&&x.current.newIndex!==E&&(x.current.newIndex=E),h!==x.current.containerId&&(x.current.containerId=h),l!==x.current.items&&(x.current.items=l)},[D,E,h,l]),f.useEffect(()=>{if(C===x.current.activeId)return;if(C!=null&&x.current.activeId==null){x.current.activeId=C;return}const de=setTimeout(()=>{x.current.activeId=C},50);return()=>clearTimeout(de)},[C]),{active:N,activeIndex:y,attributes:te,data:j,rect:F,index:g,newIndex:E,items:l,isOver:W,isSorting:D,isDragging:A,listeners:re,node:$,overIndex:u,over:ne,setNodeRef:oe,setActivatorNodeRef:se,setDroppableNodeRef:B,setDraggableNodeRef:P,transform:L??ae,transition:le()};function le(){if(L||ce&&x.current.newIndex===g)return Ae;if(!(X&&!Ie(Z)||!d)&&(D||k))return M.Transition.toString({...d,property:J})}}function ze(e,n){var t,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(t=e?.draggable)!=null?t:n.draggable,droppable:(r=e?.droppable)!=null?r:n.droppable}}T.Down,T.Right,T.Up,T.Left;const G=[{title:"ç¨®æ¤ç‰©çš„é †åº",items:["ğŸŒ±","ğŸª´","ğŸŒ¿","ğŸŒ»"],correct:[0,1,2,3]},{title:"ä¸€å¤©çš„æ™‚é–“",items:["ğŸŒ…","â˜€ï¸","ğŸŒ†","ğŸŒ™"],correct:[0,1,2,3]},{title:"è›‹è®Šæˆé›",items:["ğŸ¥š","ğŸ£","ğŸ¥","ğŸ”"],correct:[0,1,2,3]},{title:"æ¯›æ¯›èŸ²è®Šè´è¶",items:["ğŸ›","ğŸ«›","ğŸ¦‹"],correct:[0,1,2]},{title:"æœˆäº®çš„è®ŠåŒ–",items:["ğŸŒ‘","ğŸŒ“","ğŸŒ•","ğŸŒ—"],correct:[0,1,2,3]},{title:"åšè›‹ç³•çš„é †åº",items:["ğŸ¥£","ğŸ”¥","ğŸ‚","ğŸ°"],correct:[0,1,2,3]},{title:"å­£ç¯€çš„é †åº",items:["ğŸŒ¸","â˜€ï¸","ğŸ‚","â„ï¸"],correct:[0,1,2,3]},{title:"æ•¸å­—é †åº",items:["1ï¸âƒ£","2ï¸âƒ£","3ï¸âƒ£","4ï¸âƒ£"],correct:[0,1,2,3]},{title:"æ´—æ‰‹æ­¥é©Ÿ",items:["ğŸ’§","ğŸ§¼","ğŸ‘","ğŸ§»"],correct:[0,1,2,3]},{title:"èµ·åºŠé †åº",items:["ğŸ›ï¸","ğŸš¿","ğŸ‘”","ğŸ³"],correct:[0,1,2,3]}];function Fe({id:e,emoji:n,index:t}){const{attributes:r,listeners:s,setNodeRef:o,transform:i,transition:a,isDragging:c}=Me({id:e}),d={transform:M.Transform.toString(i),transition:a,zIndex:c?100:1};return v.jsx(fe.div,{ref:o,style:d,...r,...s,className:`w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 bg-white rounded-xl shadow-lg flex items-center justify-center text-3xl sm:text-4xl md:text-5xl cursor-grab active:cursor-grabbing border-2 border-gray-200 ${c?"opacity-70 shadow-2xl":""}`,whileHover:{scale:1.05},"data-testid":`sequence-item-${t}`,children:n})}function Ue(){const[e,n]=f.useState(0),[t,r]=f.useState(0),[s,o]=f.useState(!1),[i,a]=f.useState(G[0]),[c,d]=f.useState([]),l=()=>{if(e>=10){o(!0);return}const m=G[e%G.length];a(m);const b=m.items.map((u,I)=>({id:`item-${I}`,emoji:u,originalIndex:I})).sort(()=>.5-Math.random());d(b)};f.useEffect(()=>{l()},[e]);const h=m=>{m.every((u,I)=>u.originalIndex===I)&&(ge({particleCount:50,spread:60,origin:{y:.6},colors:["#6BCB77","#FFD93D","#4D96FF"]}),r(u=>u+10),setTimeout(()=>n(u=>u+1),800))},y=m=>{const{active:b,over:u}=m;if(!u||b.id===u.id)return;const I=c.findIndex(g=>g.id===b.id),R=c.findIndex(g=>g.id===u.id),w=z(c,I,R);d(w),h(w)},p=()=>{n(0),r(0),o(!1),l()};return v.jsx(ue,{children:v.jsx(me,{title:"é †åºæ’åˆ—",score:t,totalQuestions:10,currentQuestionIndex:e,gameType:"sequence",isGameOver:s,onRestart:p,colorClass:"bg-[hsl(var(--macaron-green))] text-[hsl(var(--macaron-green-dark))]",children:v.jsxs("div",{className:"flex flex-col items-center gap-6 md:gap-10",children:[v.jsx("h3",{className:"font-display text-xl sm:text-2xl md:text-3xl font-bold text-center",children:i.title}),v.jsx("p",{className:"text-base md:text-lg text-center opacity-80",children:"æŠŠåœ–ç‰‡æŒ‰æ­£ç¢ºçš„é †åºæ’å¥½"}),v.jsx(we,{collisionDetection:Re,onDragEnd:y,children:v.jsx(Ee,{items:c.map(m=>m.id),strategy:je,children:v.jsx("div",{className:"flex gap-2 sm:gap-3 md:gap-4 p-4 bg-white/30 rounded-2xl flex-wrap justify-center",children:c.map((m,b)=>v.jsx(Fe,{id:m.id,emoji:m.emoji,index:b},m.id))})})}),v.jsxs("div",{className:"flex items-center gap-2 text-lg md:text-xl opacity-70",children:[v.jsx("span",{children:"å…ˆ"}),v.jsx("span",{className:"text-2xl",children:"â¡ï¸"}),v.jsx("span",{children:"å¾Œ"})]}),v.jsx("p",{className:"text-sm md:text-base text-center opacity-60",children:"æ‹–å‹•åœ–ç‰‡ä¾†èª¿æ•´é †åº"})]})})})}export{Ue as default};
