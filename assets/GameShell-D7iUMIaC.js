import{c as y,a as P,e as $,r as a,j as e,L as G,B as v}from"./index-CviBvuO_.js";import{e as T,D as R,a as U,b as _,c as q,d as J}from"./confetti.module-CKEGaJVs.js";import{a as K}from"./use-scores-DGCWyIxn.js";import{I as Q}from"./input-BWSWGmnF.js";import{S as g,A as V,m as x}from"./Layout-DWGereyf.js";const W=y("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const X=y("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);function ae({title:N,score:l,totalQuestions:w,currentQuestionIndex:S,gameType:k,isGameOver:d,onRestart:C,colorClass:D,children:A}){const{profile:r}=P(),{updateStats:E,checkAchievements:F}=$(),[n,i]=a.useState(r.name);a.useEffect(()=>{r.name&&i(r.name)},[r.name]);const[m,h]=a.useState(!1),[B,o]=a.useState(!1),[t,c]=a.useState(null),L=K();a.useEffect(()=>{d&&(T({particleCount:150,spread:70,origin:{y:.6},colors:["#FFC0CB","#87CEEB","#98FB98","#DDA0DD","#F0E68C"]}),E(l),setTimeout(()=>{const s=F();s&&c(s),o(!0)},1e3))},[d]);const[u,p]=a.useState(null),[I,f]=a.useState(!1),M=async()=>{if(n.trim()){h(!0);try{await L.mutateAsync({playerName:n,gameType:k,score:l}),p(l),f(!0),o(!1)}catch(s){console.error(s)}finally{h(!1)}}},z=()=>{p(null),f(!1),c(null),i(""),C()},b=()=>{o(!1),c(null)},H="/kids/".replace(/\/$/,"");return e.jsxs("div",{className:`min-h-[80vh] flex flex-col ${D} rounded-[2rem] md:rounded-[3rem] p-4 md:p-8 shadow-xl relative overflow-hidden border-4 md:border-8 border-white`,children:[e.jsx("div",{className:"absolute top-0 right-0 p-12 opacity-10 pointer-events-none",children:e.jsx(g,{className:"w-64 h-64 fill-current"})}),e.jsxs("div",{className:"flex justify-between items-center mb-6 md:mb-8 relative z-10",children:[e.jsx(G,{href:H+"/",children:e.jsx("button",{className:"bg-white/40 hover:bg-white/60 p-2 md:p-3 rounded-xl md:rounded-2xl transition-all hover:scale-105 active:scale-95 text-inherit","data-testid":"button-back",children:e.jsx(W,{className:"w-6 h-6 md:w-8 md:h-8 stroke-[3]"})})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h2",{className:"font-display text-xl md:text-3xl font-bold text-shadow",children:N}),e.jsx("div",{className:"flex gap-1 mt-1",children:Array.from({length:w}).map((s,j)=>e.jsx("div",{className:`w-2 h-2 md:w-3 md:h-3 rounded-full transition-colors duration-300 ${j<S?"bg-white":"bg-black/10"}`},j))})]}),e.jsxs("div",{className:"bg-white/40 px-4 md:px-6 py-2 rounded-xl md:rounded-2xl font-display font-bold text-xl md:text-2xl flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 md:w-6 md:h-6 fill-yellow-400 text-yellow-500"}),l]})]}),e.jsx("div",{className:"flex-1 flex flex-col justify-center relative z-10",children:e.jsx(V,{mode:"wait",children:d?e.jsxs(x.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center flex flex-col items-center gap-6 py-10",children:[e.jsx("h1",{className:"font-display text-5xl md:text-6xl font-black text-white text-shadow-lg",children:"å¤ªæ£’äº†ï¼"}),e.jsxs("div",{className:"bg-white/30 backdrop-blur-md p-6 md:p-8 rounded-3xl w-full max-w-md",children:[e.jsx("p",{className:"text-xl md:text-2xl font-bold mb-2",children:"æœ€çµ‚å¾—åˆ†"}),e.jsx("div",{className:"text-6xl md:text-8xl font-black text-white text-shadow-lg mb-4",children:u!==null?u:l}),t&&e.jsxs(x.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",delay:.3},className:"bg-white/50 p-4 rounded-2xl mb-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{className:"font-bold",children:"ç²å¾—è²¼ç´™ï¼"})]}),e.jsx("div",{className:"text-6xl",children:t.emoji}),e.jsx("div",{className:"text-sm font-medium mt-1",children:t.name})]}),I&&e.jsx("div",{className:"bg-green-100 text-green-700 px-4 py-2 rounded-xl mb-4 font-bold",children:"åˆ†æ•¸å·²å„²å­˜ï¼"}),e.jsx("button",{onClick:z,className:"w-full bg-white text-current font-bold py-3 md:py-4 rounded-2xl text-lg md:text-xl shadow-lg hover:scale-105 transition-transform","data-testid":"button-play-again",children:"å†ç©ä¸€æ¬¡"})]})]}):A})}),e.jsx(R,{open:B,onOpenChange:b,children:e.jsxs(U,{className:"sm:max-w-md border-4 border-[hsl(var(--macaron-purple))] rounded-3xl bg-white/95 backdrop-blur-xl",children:[e.jsx(_,{children:e.jsx(q,{className:"font-display text-3xl text-center text-[hsl(var(--macaron-purple-dark))]",children:t?"æ­å–œä½ ï¼":"æ–°ç´€éŒ„ï¼"})}),e.jsxs("div",{className:"flex flex-col gap-4 py-4",children:[e.jsxs("div",{className:"text-center text-lg text-muted-foreground",children:["ä½ å¾—äº† ",e.jsx("span",{className:"font-bold text-[hsl(var(--macaron-purple))] text-2xl",children:l})," åˆ†ï¼"]}),t&&e.jsxs(x.div,{initial:{scale:0},animate:{scale:1},className:"text-center bg-gradient-to-br from-yellow-100 to-pink-100 p-4 rounded-2xl",children:[e.jsx("div",{className:"text-5xl mb-2",children:t.emoji}),e.jsxs("div",{className:"font-bold",children:["ç²å¾—ã€Œ",t.name,"ã€è²¼ç´™ï¼"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t.rarity==="å‚³èªª"&&"âœ¨ å‚³èªªç´šè²¼ç´™ï¼",t.rarity==="ç¨€æœ‰"&&"ğŸ’ ç¨€æœ‰è²¼ç´™ï¼"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold ml-1",children:"ä½ çš„åå­—"}),e.jsx(Q,{value:n,onChange:s=>i(s.target.value),placeholder:"è¼¸å…¥ä½ çš„åå­—...",className:"text-lg py-6 rounded-xl border-2 border-gray-200 focus-visible:ring-[hsl(var(--macaron-purple))]",autoFocus:!0,"data-testid":"input-player-name"})]})]}),e.jsxs(J,{className:"sm:justify-center gap-2",children:[e.jsx(v,{variant:"outline",onClick:b,className:"flex-1 rounded-xl",children:"ç¨å¾Œå†èªª"}),e.jsx(v,{onClick:M,disabled:!n.trim()||m,className:"flex-1 btn-macaron btn-purple text-lg py-6 rounded-xl","data-testid":"button-save-score",children:m?"å„²å­˜ä¸­...":"å„²å­˜åˆ†æ•¸"})]})]})})]})}export{ae as G};
