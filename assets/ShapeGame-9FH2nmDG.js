import{r as d,j as e}from"./index-dxj7E4H-.js";import{L as G,m as I}from"./Layout-CmlOHSNV.js";import{G as O}from"./GameShell-CODfseyM.js";import{e as q}from"./confetti.module-BS7HiWFO.js";import{D as C,u as L,a as M}from"./core.esm-BMKAPAw8.js";import{u as k}from"./use-tts-BqW3F_mk.js";import"./use-scores-D77kwo0O.js";import"./input-R0n0rv70.js";const y=[{id:"circle",name:"圓形",color:"hsl(var(--macaron-pink))"},{id:"square",name:"正方形",color:"hsl(var(--macaron-blue))"},{id:"triangle",name:"三角形",color:"hsl(var(--macaron-green))"},{id:"star",name:"星形",color:"hsl(var(--macaron-yellow))"}];function h({shape:s,size:r=60,filled:a=!0,className:t=""}){const o={width:r,height:r};switch(s){case"circle":return e.jsx("div",{style:o,className:`rounded-full ${a?"bg-[hsl(var(--macaron-pink))]":"border-2 sm:border-4 border-dashed border-[hsl(var(--macaron-pink-dark))]"} ${t}`});case"square":return e.jsx("div",{style:o,className:`rounded-lg ${a?"bg-[hsl(var(--macaron-blue))]":"border-2 sm:border-4 border-dashed border-[hsl(var(--macaron-blue-dark))]"} ${t}`});case"triangle":return e.jsx("div",{style:{width:r,height:r*.866},className:`relative ${t}`,children:e.jsx("div",{className:a?"":"opacity-50",style:{width:0,height:0,borderLeft:`${r/2}px solid transparent`,borderRight:`${r/2}px solid transparent`,borderBottom:`${r*.866}px solid ${a?"hsl(var(--macaron-green))":"hsl(var(--macaron-green-dark))"}`}})});case"star":return e.jsx("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:a?"hsl(var(--macaron-yellow))":"none",stroke:a?"none":"hsl(var(--macaron-yellow-dark))",strokeWidth:"2",strokeDasharray:a?"0":"4",className:t,children:e.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})});default:return null}}function Q({id:s,shape:r}){const{attributes:a,listeners:t,setNodeRef:o,transform:u,isDragging:g}=M({id:s}),{speak:x}=k(),f=u?{transform:`translate(${u.x}px, ${u.y}px)`,zIndex:g?100:1,opacity:g?.8:1}:void 0;return e.jsxs(I.div,{ref:o,style:f,...t,...a,whileHover:{scale:1.1},whileTap:{scale:.95},className:"cursor-grab active:cursor-grabbing p-1.5 sm:p-2 bg-white/50 rounded-xl sm:rounded-2xl shadow-lg",onMouseEnter:()=>x(r.name),"data-testid":`draggable-${s}`,children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(h,{shape:s,size:70})}),e.jsx("div",{className:"sm:hidden",children:e.jsx(h,{shape:s,size:50})})]})}function A({id:s,isCorrect:r,hasShape:a}){const{isOver:t,setNodeRef:o}=L({id:s});return e.jsxs("div",{ref:o,className:`
        w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-xl sm:rounded-2xl flex items-center justify-center transition-all
        ${t?"scale-110 bg-white/60":"bg-white/30"}
        ${r===!0?"ring-2 sm:ring-4 ring-green-400 bg-green-100":""}
        ${r===!1?"ring-2 sm:ring-4 ring-red-400 animate-shake":""}
      `,"data-testid":`droppable-${s}`,children:[e.jsxs("div",{className:"hidden sm:block",children:[!a&&e.jsx(h,{shape:s,size:60,filled:!1}),a&&e.jsx(h,{shape:s,size:60,filled:!0})]}),e.jsxs("div",{className:"sm:hidden",children:[!a&&e.jsx(h,{shape:s,size:40,filled:!1}),a&&e.jsx(h,{shape:s,size:40,filled:!0})]})]})}function V(){const[s,r]=d.useState(0),[a,t]=d.useState(0),[o,u]=d.useState([]),[g,x]=d.useState([]),[f,S]=d.useState({}),[$,b]=d.useState({}),[N,w]=d.useState(!1),{speak:j}=k(),D=()=>{if(s>=10){w(!0);return}const i=[...y].sort(()=>.5-Math.random()).slice(0,3).map(v=>v.id),c=[...i].sort(()=>.5-Math.random());u(i),x(c),S({}),b({}),j("把餅乾放到正確的位置吧！")};d.useEffect(()=>{D()},[s]);const R=n=>{const{active:i,over:c}=n;if(!c)return;const v=i.id,m=c.id;if(v===m){q({particleCount:20,spread:40,origin:{y:.6}}),j("太棒了！"),S(l=>({...l,[m]:!0})),b(l=>({...l,[m]:!0})),x(l=>l.filter(T=>T!==v)),t(l=>l+10);const p={...f,[m]:!0};Object.keys(p).length===o.length&&setTimeout(()=>r(l=>l+1),800)}else j("再試試看！"),b(p=>({...p,[m]:!1})),setTimeout(()=>b(p=>({...p,[m]:null})),500)},E=()=>{r(0),t(0),w(!1)};return e.jsx(G,{children:e.jsx(O,{title:"形狀餅乾店",score:a,totalQuestions:10,currentQuestionIndex:s,gameType:"shape",isGameOver:N,onRestart:E,colorClass:"bg-[hsl(var(--macaron-yellow))] text-[hsl(var(--macaron-yellow-dark))]",children:e.jsx(C,{onDragEnd:R,children:e.jsxs("div",{className:"flex flex-col items-center gap-4 sm:gap-6 md:gap-8",children:[e.jsx("h3",{className:"font-display text-lg sm:text-xl md:text-2xl font-bold text-center",children:"把餅乾放到正確的烤盤裡！"}),e.jsx("div",{className:"bg-amber-100 p-3 sm:p-4 md:p-6 rounded-xl sm:rounded-2xl md:rounded-[2rem] shadow-inner border-2 sm:border-4 border-amber-200",children:e.jsx("div",{className:"flex gap-2 sm:gap-3 md:gap-4",children:o.map(n=>e.jsx(A,{id:n,isCorrect:$[n],hasShape:f[n]||!1},n))})}),e.jsx("div",{className:"flex gap-2 sm:gap-3 md:gap-4 mt-2 sm:mt-4",children:g.map(n=>{const i=y.find(c=>c.id===n);return e.jsx(Q,{id:n,shape:i},n)})})]})})})})}export{V as default};
